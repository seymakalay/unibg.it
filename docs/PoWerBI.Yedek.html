<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>PoWerBI.Yedek.knit</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Seyma Kalay, Ph.D.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="Journal.html">
    <span class="fa fa-book"></span>
     
    CV
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-box"></span>
     
    Pacchetti
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Apprendimento Automatico</li>
    <li>
      <a href="https://github.com/seymakalay/pomodoro">pomodoro CRAN</a>
    </li>
    <li>
      <a href="pomodoro.tutorial.html">pomodoro vignette</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Visualizzazione Dati</li>
    <li>
      <a href="https://github.com/seymakalay/pepe">pepe CRAN</a>
    </li>
    <li>
      <a href="pepe.tutorial.html">pepe vignette</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-gem"></span>
     
    Shiny
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Mappatura</li>
    <li>
      <a href="MapApp.html">Mappa semplice</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Visualizzazione</li>
    <li>
      <a href="VisualApp.html">Plot</a>
    </li>
  </ul>
</li>
<li>
  <a href="tableau.html">
    <span class="fa fa-star"></span>
     
    Tableau
  </a>
</li>
<li>
  <a href="powerbi.html">
    <span class="fa fa-chart-bar"></span>
     
    Power BI
  </a>
</li>
<li>
  <a href="sql.html">
    <span class="fa fa-database"></span>
     
    SQL
  </a>
</li>
<li>
  <a href="snowflake.html">
    <span class="fa fa-snowflake"></span>
     
    SnowFlake
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seymakalay">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/users/9209203/seyma-kalay?tab=profile">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">CVs</li>
    <li>
      <a href="./SK_CV_Eng.pdf">English CV</a>
    </li>
    <li>
      <a href="./SK_CV_Ita.pdf">Italian CV</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Certificates</li>
    <li>
      <a href="./images/AU_Business.pdf">Auburn Business</a>
    </li>
    <li>
      <a href="./images/CourseraAzure.pdf">Azure</a>
    </li>
    <li>
      <a href="./images/CourseraPowerBi.pdf">Power Bi</a>
    </li>
    <li>
      <a href="./images/Python4_Data_Analysis.pdf">Python</a>
    </li>
    <li>
      <a href="./images/CourseraSnowFlake.pdf">Snow Flake</a>
    </li>
    <li>
      <a href="./images/CourseraAdvanceSQL.pdf">SQL</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.linkedin.com/in/seymakalay/">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://seymakalay.github.io/unibg/index.html">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<!--\1 
---
title: ""
output:
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: flatly
    highlight: tango
#header-includes:
#- \usepackage{caption}  
   #  - \usepackage{placeins}
---



---
title: ""
output:
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: flatly
    highlight: tango
#header-includes:
#- \usepackage{caption}  
   #  - \usepackage{placeins}
---

 
---
title: ""
output:
  html_document:
    theme: flatly
    highlight: tango
    toc: yes
    toc_float: yes
    collapsed: no
    number_sections: no
    toc_depth: 1
  pdf_document:
    toc: yes
    toc_depth: '1'
---

 
---
title: ""
output:
  html_document:
    toc: TRUE
    toc_float: TRUE
    theme: flatly
    highlight: tango
---
   \1-->
<!--\1  <span style="color:red">pomodoro</span> \1-->
<!--\1   \1-->
<style type="text/css">
li {
    content:attr(aria-label);
    font-size:100%;
    margin-right:-10px;
}
</style>
<blockquote>
<p>This page is under construction.</p>
</blockquote>
<blockquote>
<p>This tutorial provides a guideline for fundamental concepts in
PowerBI.</p>
</blockquote>
<!--\1  > In this page, I will show the Must Have for a Power BI report.1-->
<div id="dimcalendar" class="section level1">
<h1>DimCalendar</h1>
<p>Date Dimension is useful for scenarios mentioned below;</p>
<body>
<ul>
<li>
Ability to slice and dice by many date attributes (such as week number,
half year, day of year, and etc.).
</li>
<li>
Helps to calculate ‘Time Intelligence’ functions (MTD, QTD, YTD,..etc.).
</li>
<li>
Consistency in Analysis.
</li>
</ul>
</body>
<p>Let's create the <code>dimCalendar</code> data flow where the Fiscal
year starts in May.</p>
<pre><code>let
  YearStart = 2020,
  Source = List.Dates(#date(YearStart,1,1),365*8,#duration(1, 0, 0, 0)),
  #&quot;Converted to table&quot; = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
  #&quot;Renamed columns&quot; = Table.RenameColumns(#&quot;Converted to table&quot;, {{&quot;Column1&quot;, &quot;Date&quot;}}),
  #&quot;Changed column type&quot; = Table.TransformColumnTypes(#&quot;Renamed columns&quot;, {{&quot;Date&quot;, type date}}),
    // sample comment
    #&quot;Add Fiscal Year Start&quot; = Table.AddColumn(#&quot;Changed column type&quot;, &quot;Fiscal Year Start&quot;, each if [Date] &gt; Date.AddDays(#date(Date.Year([Date]),4,30), Date.DayOfWeek(#date(Date.Year([Date]),4,30),5)*-1) then
        Date.AddDays(#date(Date.Year([Date]),4,30), Date.DayOfWeek(#date(Date.Year([Date]),4,30),5)*-1+1) else
        Date.AddDays(#date(Date.Year([Date])-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1), type date),
    ref_FiscalStartCalendar = List.Min(#&quot;Add Fiscal Year Start&quot;[Fiscal Year Start]),
    #&quot;Add Fiscal Year End&quot; = Table.AddColumn(#&quot;Add Fiscal Year Start&quot;, &quot;Fiscal Year End&quot;, each if [Date] &gt; Date.AddDays(#date(Date.Year([Date]),4,30), Date.DayOfWeek(#date(Date.Year([Date]),4,30),5)*-1) then
        Date.AddDays(#date(Date.Year([Date])+1,4,30), Date.DayOfWeek(#date(Date.Year([Date])+1,4,30),5)*-1) else
        Date.AddDays(#date(Date.Year([Date]),4,30), Date.DayOfWeek(#date(Date.Year([Date]),4,30),5)*-1), type date),
    #&quot;Add FIscal Year&quot; = Table.AddColumn(#&quot;Add Fiscal Year End&quot;, &quot;Fiscal Year&quot;, each Text.Combine({&quot;FY&quot;, Text.Range(Text.From(Date.Year([Fiscal Year End])),2,2)}), type text),
    #&quot;Add Fiscal Weeks&quot; = Table.AddColumn(#&quot;Add FIscal Year&quot;, &quot;Fiscal Weeks&quot;, each (Duration.Days([Fiscal Year End]-[Fiscal Year Start])+1)/7, Int64.Type),
    #&quot;Add Fiscal Month 01 End 4/5&quot; = Table.AddColumn(#&quot;Add Fiscal Weeks&quot;, &quot;Fiscal Month 01 End&quot;, each if [Fiscal Weeks]=53 then Date.AddDays([Fiscal Year Start],35-1) else Date.AddDays([Fiscal Year Start],28-1), type date),
    #&quot;Add Fiscal Month 02 End 5&quot; = Table.AddColumn(#&quot;Add Fiscal Month 01 End 4/5&quot;, &quot;Fiscal Month 02 End&quot;, each Date.AddDays([Fiscal Month 01 End],35), type date),
    #&quot;Add Fiscal Month 03 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 02 End 5&quot;, &quot;Fiscal Month 03 End&quot;, each Date.AddDays([Fiscal Month 02 End],28), type date),
    #&quot;Add Fiscal Month 04 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 03 End 4&quot;, &quot;Fiscal Month 04 End&quot;, each Date.AddDays([Fiscal Month 03 End],28), type date),
    #&quot;Add Fiscal Month 05 End 5&quot; = Table.AddColumn(#&quot;Add Fiscal Month 04 End 4&quot;, &quot;Fiscal Month 05 End&quot;, each Date.AddDays([Fiscal Month 04 End],35), type date),
    #&quot;Add Fiscal Month 06 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 05 End 5&quot;, &quot;Fiscal Month 06 End&quot;, each Date.AddDays([Fiscal Month 05 End],28), type date),
    #&quot;Add Fiscal Month 07 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 06 End 4&quot;, &quot;Fiscal Month 07 End&quot;, each Date.AddDays([Fiscal Month 06 End],28), type date),
    #&quot;Add Fiscal Month 08 End 5&quot; = Table.AddColumn(#&quot;Add Fiscal Month 07 End 4&quot;, &quot;Fiscal Month 08 End&quot;, each Date.AddDays([Fiscal Month 07 End],35), type date),
    #&quot;Add Fiscal Month 09 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 08 End 5&quot;, &quot;Fiscal Month 09 End&quot;, each Date.AddDays([Fiscal Month 08 End],28), type date),
    #&quot;Add Fiscal Month 10 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 09 End 4&quot;, &quot;Fiscal Month 10 End&quot;, each Date.AddDays([Fiscal Month 09 End],28), type date),
    #&quot;Add Fiscal Month 11 End 5&quot; = Table.AddColumn(#&quot;Add Fiscal Month 10 End 4&quot;, &quot;Fiscal Month 11 End&quot;, each Date.AddDays([Fiscal Month 10 End],35), type date),
    #&quot;Add Fiscal Month 12 End 4&quot; = Table.AddColumn(#&quot;Add Fiscal Month 11 End 5&quot;, &quot;Fiscal Month 12 End&quot;, each Date.AddDays([Fiscal Month 11 End],28), type date),
    #&quot;Add Fiscal Period Num&quot; = Table.AddColumn(#&quot;Add Fiscal Month 12 End 4&quot;, &quot;Fiscal Month&quot;, each if
[Date] &lt;= [Fiscal Month 01 End] then 1 else if
[Date] &lt;= [Fiscal Month 02 End] then 2 else if
[Date] &lt;= [Fiscal Month 03 End] then 3 else if
[Date] &lt;= [Fiscal Month 04 End] then 4 else if
[Date] &lt;= [Fiscal Month 05 End] then 5 else if
[Date] &lt;= [Fiscal Month 06 End] then 6 else if
[Date] &lt;= [Fiscal Month 07 End] then 7 else if
[Date] &lt;= [Fiscal Month 08 End] then 8 else if
[Date] &lt;= [Fiscal Month 09 End] then 9 else if
[Date] &lt;= [Fiscal Month 10 End] then 10 else if
[Date] &lt;= [Fiscal Month 11 End] then 11 else if
[Date] &lt;= [Fiscal Month 12 End] then 12


else null, Int64.Type),
    #&quot;Add FY&quot; = Table.AddColumn(#&quot;Add Fiscal Period Num&quot;, &quot;FY&quot;, each Date.Year([Fiscal Year End]), Int64.Type),
    #&quot;Add Day Name&quot; = Table.AddColumn(#&quot;Add FY&quot;, &quot;Day Name&quot;, each Date.DayOfWeekName([Date]), type text),
    #&quot;Add Day&quot; = Table.AddColumn(#&quot;Add Day Name&quot;, &quot;Day&quot;, each Date.Day([Date]), Int64.Type),
    #&quot;Add Days in Month&quot; = Table.AddColumn(#&quot;Add Day&quot;, &quot;Days in month&quot;, each Date.DaysInMonth([Date]), Int64.Type),
    #&quot;Add End of Month&quot; = Table.AddColumn(#&quot;Add Days in Month&quot;, &quot;End of month&quot;, each Date.EndOfMonth([Date]), type date),
    #&quot;Add Month&quot; = Table.AddColumn(#&quot;Add End of Month&quot;, &quot;Month&quot;, each Date.Month([Date]), Int64.Type),
    #&quot;Add Fiscal Quarter Num&quot; = Table.AddColumn(#&quot;Add Month&quot;, &quot;Fiscal Quarter Number&quot;, each if [Fiscal Month] &lt;= 3 then 1 else if [Fiscal Month] &lt;= 6 then 2 else if [Fiscal Month] &lt;= 9 then 3 else if [Fiscal Month] &lt;= 12 then 4 else 999, Int64.Type),
    #&quot;Add Fiscal Quarter&quot; = Table.AddColumn(#&quot;Add Fiscal Quarter Num&quot;, &quot;Fiscal Quarter&quot;, each Text.Combine({&quot;Q&quot;, Text.From([Fiscal Quarter Number])}), type text),
    #&quot;Add Fiscal Quarter-Year&quot; = Table.AddColumn(#&quot;Add Fiscal Quarter&quot;, &quot;Fiscal Quarter-Year&quot;, each Text.Combine({[Fiscal Quarter],&quot;-&quot;,[Fiscal Year]}), type text),
    #&quot;Add Fiscal Month Name&quot; = Table.AddColumn(#&quot;Add Fiscal Quarter-Year&quot;, &quot;Fiscal Month Name&quot;, each if [Fiscal Month]&lt;=8 then Text.Start(Date.MonthName(#date([FY],[Fiscal Month]+4,15)),3) else Text.Start(Date.MonthName(#date([FY],[Fiscal Month]-8,15)),3), type text),
    #&quot;Add Fiscal Month-Year&quot; = Table.AddColumn(#&quot;Add Fiscal Month Name&quot;, &quot;Fiscal Month-Year&quot;, each Text.Combine({[Fiscal Month Name], [Fiscal Year]}, &quot;-&quot;), type text),
    #&quot;Add Fiscal Year-Month num&quot; = Table.AddColumn(#&quot;Add Fiscal Month-Year&quot;, &quot;Fiscal Year-Month num&quot;, each [FY]*100+[Fiscal Month], Int64.Type),
    #&quot;Add Fiscal Year-Quarter num&quot; = Table.AddColumn(#&quot;Add Fiscal Year-Month num&quot;, &quot;Fiscal Year-Quarter num&quot;, each [FY]*100+[Fiscal Quarter Number], Int64.Type),
    #&quot;Add Fiscal week num&quot; = Table.AddColumn(#&quot;Add Fiscal Year-Quarter num&quot;, &quot;Fiscal Week num&quot;, each Number.RoundUp(Duration.Days([Date]-Date.AddDays([Fiscal Year Start],-1))/7), Int64.Type),
  AddDayOfFiscalYear = Table.AddColumn(#&quot;Add Fiscal week num&quot;, &quot;Day of Fiscal Year&quot;, each Duration.Days([Date] - [Fiscal Year Start]) + 1, Int64.Type),
  AddDateOffset = Table.TransformColumnTypes(Table.AddColumn(AddDayOfFiscalYear, &quot;Date Offset&quot;, each if DateTime.Date(DateTime.FixedLocalNow()) &gt; [Date]
then (-1) * Duration.Days(DateTime.Date(DateTime.FixedLocalNow())-[Date]) else if DateTime.Date(DateTime.FixedLocalNow()) &lt; [Date] then
Duration.Days([Date] - DateTime.Date(DateTime.FixedLocalNow())) else 0), {{&quot;Date Offset&quot;, Int64.Type}}),

    fiscalWeeks =
      let
        #&quot;Removed Other Columns&quot; = Table.SelectColumns(AddDateOffset,{&quot;FY&quot;, &quot;Fiscal Week num&quot;,&quot;Date&quot;}),
        #&quot;Grouped Rows&quot; = Table.Group(#&quot;Removed Other Columns&quot;, {&quot;FY&quot;, &quot;Fiscal Week num&quot;}, {{&quot;Start of Fiscal Week&quot;, each List.Min([Date]), type nullable date}, {&quot;End of Fiscal Week&quot;, each List.Max([Date]), type nullable date}}),
        #&quot;Sorted Rows&quot; = Table.Sort(#&quot;Grouped Rows&quot;,{{&quot;FY&quot;, Order.Ascending}, {&quot;Fiscal Week num&quot;, Order.Ascending}}),
        #&quot;Added Index&quot; = Table.AddIndexColumn(#&quot;Sorted Rows&quot;, &quot;Sequential Fiscal Week&quot;, 1, 1, Int64.Type),
        #&quot;Added Custom&quot; = Table.AddColumn(#&quot;Added Index&quot;, &quot;Fiscal Week Offset&quot;, each Table.SelectColumns(Table.LastN(Table.SelectRows(#&quot;Added Index&quot;, each Date.IsInPreviousNDays([Start of Fiscal Week], 7)),1),&quot;Sequential Fiscal Week&quot; )),
        #&quot;Expanded Fiscal Week Offset&quot; = Table.ExpandTableColumn(#&quot;Added Custom&quot;, &quot;Fiscal Week Offset&quot;, {&quot;Sequential Fiscal Week&quot;}, {&quot;CurrFiscWk&quot;}),
        #&quot;Changed Type&quot; = Table.TransformColumnTypes(#&quot;Expanded Fiscal Week Offset&quot;,{{&quot;CurrFiscWk&quot;, Int64.Type}}),
        #&quot;Added Custom1&quot; = Table.AddColumn(#&quot;Changed Type&quot;, &quot;Fiscal Week Offset&quot;, each [Sequential Fiscal Week] - [CurrFiscWk], Int64.Type),
        #&quot;Removed Columns&quot; = Table.RemoveColumns(#&quot;Added Custom1&quot;,{&quot;CurrFiscWk&quot;})
      in
        #&quot;Removed Columns&quot;,

    ResetCal = AddDateOffset,
    #&quot;Merged Queries&quot; = Table.NestedJoin(ResetCal, {&quot;FY&quot;, &quot;Fiscal Week num&quot;}, fiscalWeeks, {&quot;FY&quot;, &quot;Fiscal Week num&quot;}, &quot;Add_SequentialWeek&quot;, JoinKind.LeftOuter),
    #&quot;Expanded Add_SequentialWeek&quot; = Table.ExpandTableColumn(#&quot;Merged Queries&quot;, &quot;Add_SequentialWeek&quot;, {&quot;Start of Fiscal Week&quot;, &quot;End of Fiscal Week&quot;, &quot;Sequential Fiscal Week&quot;, &quot;Fiscal Week Offset&quot;}, {&quot;Start of Fiscal Week&quot;, &quot;End of Fiscal Week&quot;, &quot;Sequential Fiscal Week&quot;, &quot;Fiscal Week Offset&quot;}),
 

    Add_SequentialWeek = Table.AddColumn(#&quot;Expanded Add_SequentialWeek&quot;, &quot;Sequential Week Number&quot;, each Number.RoundUp(Duration.Days([Date]-Date.AddDays(Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1),-1))/7) - Number.RoundUp(Duration.Days(#date(YearStart,1,1)-Date.AddDays(Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1),-1))/7), Int64.Type),
    Add_StartOfWeek = Table.AddColumn(Add_SequentialWeek, &quot;Start of Week&quot;, each Date.AddDays( Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1)
    ,(-7) + 7 * Number.RoundUp(Duration.Days([Date]-Date.AddDays(Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1),-1))/7) ), type date),
    Add_EndOfWeek = Table.AddColumn(Add_StartOfWeek, &quot;End of Week&quot;, each Date.AddDays( Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1)
    ,(-1) + 7 * Number.RoundUp(Duration.Days([Date]-Date.AddDays(Date.AddDays(#date(YearStart-1,4,30), Date.DayOfWeek(#date(Date.Year([Date])-1,4,30),5)*-1+1),-1))/7) ), type date),

    #&quot;Add Month name&quot; = Table.AddColumn(Add_EndOfWeek, &quot;Month name&quot;, each Date.MonthName([Date]), type text),
    #&quot;Changed Type&quot; = Table.TransformColumnTypes(#&quot;Add Month name&quot;,{{&quot;Date&quot;, type date}, {&quot;Fiscal Year Start&quot;, type date}, {&quot;Fiscal Year End&quot;, type date}, {&quot;Fiscal Month 01 End&quot;, type date}, {&quot;Fiscal Month 02 End&quot;, type date}, {&quot;Fiscal Month 03 End&quot;, type date}, {&quot;Fiscal Month 04 End&quot;, type date}, {&quot;Fiscal Month 05 End&quot;, type date}, {&quot;Fiscal Month 06 End&quot;, type date}, {&quot;Fiscal Month 07 End&quot;, type date}, {&quot;Fiscal Year&quot;, type text}, {&quot;Fiscal Weeks&quot;, Int64.Type}, {&quot;Fiscal Month 08 End&quot;, type date}, {&quot;Fiscal Month 09 End&quot;, type date}, {&quot;Fiscal Month 10 End&quot;, type date}, {&quot;Fiscal Month 11 End&quot;, type date}, {&quot;Fiscal Month 12 End&quot;, type date}, {&quot;Fiscal Month&quot;, Int64.Type}, {&quot;FY&quot;, Int64.Type}, {&quot;Day&quot;, Int64.Type}, {&quot;Days in month&quot;, Int64.Type}, {&quot;Day Name&quot;, type text}, {&quot;End of month&quot;, type date}, {&quot;Month&quot;, Int64.Type}, {&quot;Fiscal Quarter Number&quot;, Int64.Type}, {&quot;Fiscal Quarter&quot;, type text}, {&quot;Fiscal Quarter-Year&quot;, type text}, {&quot;Fiscal Month Name&quot;, type text}, {&quot;Fiscal Month-Year&quot;, type text}, {&quot;Month name&quot;, type text}, {&quot;Fiscal Year-Month num&quot;, Int64.Type}, {&quot;Fiscal Year-Quarter num&quot;, Int64.Type}, {&quot;Fiscal Week num&quot;, Int64.Type}}),
    // code added below is from Matt Hecht on 3/22/23. Added start/end of fiscal quarters and months, with offsets to support them
  Add_Start_Of_Fiscal_mo = Table.AddColumn(#&quot;Changed Type&quot;, &quot;Start of Fiscal Month&quot;, each
      if [Fiscal Month] = 1 then [Fiscal Year Start] else
      if [Fiscal Month] = 2 then Date.AddDays([Fiscal Month 01 End], 1) else
      if [Fiscal Month] = 3 then Date.AddDays([Fiscal Month 02 End], 1) else
      if [Fiscal Month] = 4 then Date.AddDays([Fiscal Month 03 End], 1) else
      if [Fiscal Month] = 5 then Date.AddDays([Fiscal Month 04 End], 1) else
      if [Fiscal Month] = 6 then Date.AddDays([Fiscal Month 05 End], 1) else
      if [Fiscal Month] = 7 then Date.AddDays([Fiscal Month 06 End], 1) else
      if [Fiscal Month] = 8 then Date.AddDays([Fiscal Month 07 End], 1) else
      if [Fiscal Month] = 9 then Date.AddDays([Fiscal Month 08 End], 1) else
      if [Fiscal Month] = 10 then Date.AddDays([Fiscal Month 09 End], 1) else
      if [Fiscal Month] = 11 then Date.AddDays([Fiscal Month 10 End], 1) else
      if [Fiscal Month] = 12 then Date.AddDays([Fiscal Month 11 End], 1) else
      null, type date ),
    Add_End_Of_Fiscal_mo = Table.AddColumn(Add_Start_Of_Fiscal_mo, &quot;End of Fiscal Month&quot;, each
      if [Fiscal Month] = 1 then [Fiscal Month 01 End] else
      if [Fiscal Month] = 2 then [Fiscal Month 02 End] else
      if [Fiscal Month] = 3 then [Fiscal Month 03 End] else
      if [Fiscal Month] = 4 then [Fiscal Month 04 End] else
      if [Fiscal Month] = 5 then [Fiscal Month 05 End] else
      if [Fiscal Month] = 6 then [Fiscal Month 06 End] else
      if [Fiscal Month] = 7 then [Fiscal Month 07 End] else
      if [Fiscal Month] = 8 then [Fiscal Month 08 End] else
      if [Fiscal Month] = 9 then [Fiscal Month 09 End] else
      if [Fiscal Month] = 10 then [Fiscal Month 10 End] else
      if [Fiscal Month] = 11 then [Fiscal Month 11 End] else
      if [Fiscal Month] = 12 then [Fiscal Month 12 End] else
      null, type date ),
  CurrDt_Index = if List.Max( Add_Start_Of_Fiscal_mo[Date] ) &gt; DateTime.Date(DateTime.FixedLocalNow()) then DateTime.Date(DateTime.FixedLocalNow()) else Date.AddDays( List.Max( Add_Start_Of_Fiscal_mo[Date] ), -1 ),
  CurrDt_Start_Fmo_Index = Record.Field(Table.Min(Table.Buffer(Table.SelectRows( Add_End_Of_Fiscal_mo, each [End of Fiscal Month] &gt; CurrDt_Index ) ), &quot;Start of Fiscal Month&quot;), &quot;Start of Fiscal Month&quot;),
  Add_Fiscal_Month_Offset = Table.AddColumn(Add_End_Of_Fiscal_mo, &quot;Fiscal Month Offset&quot;, each Number.Round(Number.From( [Start of Fiscal Month] - CurrDt_Start_Fmo_Index)/ 30,0), Int64.Type),
    Add_Start_Of_Fiscal_Qtr = Table.AddColumn(Add_Fiscal_Month_Offset, &quot;Start of Fiscal Quarter&quot;, each
      if [Fiscal Month] = 1 then [Fiscal Year Start] else
      if [Fiscal Month] = 2 then [Fiscal Year Start] else
      if [Fiscal Month] = 3 then [Fiscal Year Start] else
      if [Fiscal Month] = 4 then Date.AddDays([Fiscal Month 03 End], 1) else
      if [Fiscal Month] = 5 then Date.AddDays([Fiscal Month 03 End], 1) else
      if [Fiscal Month] = 6 then Date.AddDays([Fiscal Month 03 End], 1) else
      if [Fiscal Month] = 7 then Date.AddDays([Fiscal Month 06 End], 1) else
      if [Fiscal Month] = 8 then Date.AddDays([Fiscal Month 06 End], 1) else
      if [Fiscal Month] = 9 then Date.AddDays([Fiscal Month 06 End], 1) else
      if [Fiscal Month] = 10 then Date.AddDays([Fiscal Month 09 End], 1) else
      if [Fiscal Month] = 11 then Date.AddDays([Fiscal Month 09 End], 1) else
      if [Fiscal Month] = 12 then Date.AddDays([Fiscal Month 09 End], 1) else
      null, type date ),
    Add_End_Of_Fiscal_Qtr = Table.AddColumn(Add_Start_Of_Fiscal_Qtr, &quot;End of Fiscal Quarter&quot;, each
      if [Fiscal Month] = 1 then [Fiscal Month 03 End] else
      if [Fiscal Month] = 2 then [Fiscal Month 03 End] else
      if [Fiscal Month] = 3 then [Fiscal Month 03 End] else
      if [Fiscal Month] = 4 then [Fiscal Month 06 End] else
      if [Fiscal Month] = 5 then [Fiscal Month 06 End] else
      if [Fiscal Month] = 6 then [Fiscal Month 06 End] else
      if [Fiscal Month] = 7 then [Fiscal Month 09 End] else
      if [Fiscal Month] = 8 then [Fiscal Month 09 End] else
      if [Fiscal Month] = 9 then [Fiscal Month 09 End] else
      if [Fiscal Month] = 10 then [Fiscal Month 12 End] else
      if [Fiscal Month] = 11 then [Fiscal Month 12 End] else
      if [Fiscal Month] = 12 then [Fiscal Month 12 End] else
      null, type date ),
    CurrDt_Start_Fqtr_Index = Record.Field(Table.Min(Table.Buffer(Table.SelectRows( Add_End_Of_Fiscal_Qtr, each [End of Fiscal Quarter] &gt; CurrDt_Index ) ), &quot;Start of Fiscal Quarter&quot;), &quot;Start of Fiscal Quarter&quot;),
    CurrDt_Start_Fyr_Index = Record.Field(Table.Min(Table.Buffer(Table.SelectRows( Add_End_Of_Fiscal_Qtr, each [Fiscal Year End] &gt; CurrDt_Index ) ), &quot;Fiscal Year Start&quot;), &quot;Fiscal Year Start&quot;),
    Add_Fiscal_Qtr_Offset = Table.AddColumn(Add_End_Of_Fiscal_Qtr, &quot;Fiscal Quarter Offset&quot;, each Number.Round(Number.From( [Start of Fiscal Quarter] - CurrDt_Start_Fqtr_Index)/ 90,0), Int64.Type),
  #&quot;Added custom 1&quot; = Table.TransformColumnTypes(Table.AddColumn(Add_Fiscal_Qtr_Offset, &quot;Fiscal Year Offset&quot;, each Number.Round(Number.From( [Fiscal Year Start] - CurrDt_Start_Fyr_Index)/ 365,0)), {{&quot;Fiscal Year Offset&quot;, Int64.Type}}),
  #&quot;Inserted prefix&quot; = Table.AddColumn(#&quot;Added custom 1&quot;, &quot;Fiscal YR&quot;, each &quot;FY&quot; &amp; Text.From([FY]), type text),
  #&quot;Added custom&quot; = Table.AddColumn(#&quot;Inserted prefix&quot;, &quot;Fiscal Yr-Wk&quot;, each [Fiscal Year] &amp; &quot;-&quot; &amp; Text.From([Fiscal Week num]), type text),
  AddDayOfFiscalMonth = Table.TransformColumnTypes(Table.AddColumn(#&quot;Added custom&quot;, &quot;Day of Fiscal Month&quot;, each Duration.Days([Date] - [Start of Fiscal Month]) + 1), {{&quot;Day of Fiscal Month&quot;, Int64.Type}}),
  AddDayOfFiscalQuarter = Table.TransformColumnTypes(Table.AddColumn(AddDayOfFiscalMonth, &quot;Day of Fiscal Quarter&quot;, each Duration.Days([Date]-[Start of Fiscal Quarter]) + 1), {{&quot;Day of Fiscal Quarter&quot;, Int64.Type}}),
  AddMonthOfFiscalQuarter = Table.TransformColumnTypes(Table.AddColumn(AddDayOfFiscalQuarter, &quot;Month Of Fiscal Quarter&quot;, each Number.Round( Duration.Days([Start of Fiscal Month]-[Start of Fiscal Quarter])/30, 0 ) + 1), {{&quot;Month Of Fiscal Quarter&quot;, Int64.Type}}),
  AddPeriodNo = Table.TransformColumnTypes(Table.AddColumn(AddMonthOfFiscalQuarter, &quot;Fiscal Period&quot;, each Text.PadStart(Text.From([Fiscal Month]),3,&quot;0&quot;)), {{&quot;Fiscal Period&quot;, type text}}),
  AddSeqFiscalYear = Table.TransformColumnTypes(Table.AddColumn(AddPeriodNo, &quot;Sequential Fiscal Year&quot;, each 1 + Number.Round(Number.From([Fiscal Year Start] - ref_FiscalStartCalendar) / 365 , 0)), {{&quot;Sequential Fiscal Year&quot;, Int64.Type}}),
  AddSeqFiscalQtr = Table.TransformColumnTypes(Table.AddColumn(AddSeqFiscalYear, &quot;Sequential Fiscal Quarter&quot;, each -1 + Number.Round(Number.From([Start of Fiscal Quarter] - ref_FiscalStartCalendar) / 90 , 0)), {{&quot;Sequential Fiscal Quarter&quot;, Int64.Type}}),
  AddSeqFiscalMonth = Table.TransformColumnTypes(Table.AddColumn(AddSeqFiscalQtr, &quot;Sequential Fiscal Month&quot;, each -7 + Number.Round(Number.From([Start of Fiscal Month] - ref_FiscalStartCalendar) / 30 , 0)), {{&quot;Sequential Fiscal Month&quot;, Int64.Type}}),
  AddFiscWeekOfQtr = Table.TransformColumnTypes(Table.AddColumn(AddSeqFiscalMonth, &quot;Week of Fiscal Quarter Num&quot;, each 1 + Number.Round( Number.From([Start of Fiscal Week] - [Start of Fiscal Quarter]) / 7, 0 )), {{&quot;Week of Fiscal Quarter Num&quot;, Int64.Type}}),
  AddWkOfFiscYr = Table.TransformColumnTypes(Table.AddColumn(AddFiscWeekOfQtr, &quot;Week of Fiscal Year&quot;, each &quot;W&quot;&amp;Number.ToText([Fiscal Week num])), {{&quot;Week of Fiscal Year&quot;, type text}}),
  #&quot;Added custom 2&quot; = Table.TransformColumnTypes(Table.AddColumn(AddWkOfFiscYr, &quot;Week of Fiscal Quarter&quot;, each &quot;W&quot;&amp;Number.ToText([Week of Fiscal Quarter Num])), {{&quot;Week of Fiscal Quarter&quot;, type text}}),
  #&quot;Added Custom&quot; = Table.TransformColumnTypes(Table.AddColumn(#&quot;Added custom 2&quot;, &quot;WeekDaysOfMonth&quot;, each Duration.Days([End of Fiscal Month] -[End of Fiscal Week])) ,{{&quot;WeekDaysOfMonth&quot;, Int64.Type}})
in
    #&quot;Added Custom&quot;</code></pre>
</div>
<div id="time-intelegence-in-dax" class="section level1">
<h1>Time Intelegence in DAX</h1>
<p>‘Time Intelligence’ functions help to compare the data, based on the
time periods (days, months, quarters, and years). These functions,
mostly used for financial and supply chain reports, compare the
earnings, gains,…etc. over time (MTD, QTD, and YTD).</p>
<p>Let's create a ‘z-Time Intelligence’ calculation group in Power BI
model view. After setting up the group measures, mentioned bellow, we
can assign the ‘Time Intelligence’ column name as ‘Time Intelligence
Type’ and set the ordinal of the measures by moving them up or down.
Lastly, let's check the ordinality of ‘z-Time Intelligence’ calculation
group on the table view. <!--\1 [link](#dimcalendar) --></p>
<div id="current-year" class="section level2">
<h2>Current Year</h2>
<pre><code>CY = SELECTEDMEASURE()</code></pre>
</div>
<div id="last-year" class="section level2">
<h2>Last Year</h2>
<pre><code>LY = 
var _currOffset = MAX( &#39;Calendar&#39;[Fiscal Month Offset] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Fiscal Month Offset] ) - 12
var _offsetEnd = _currOffset - 12 
var _currYr = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Fiscal Month Offset] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Fiscal Month Offset] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    _rslt,
    _currOffset &lt;= 0 || _currYr &lt;= 0
)
</code></pre>
</div>
<div id="current-vs-last-year" class="section level2">
<h2>Current vs Last Year</h2>
<pre><code>CY vs LY = 
var _currOffset = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Sequential Fiscal Month] ) - 12
var _offsetEnd = _currOffset - 12
var _cy = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Month] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Sequential Fiscal Month] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    SELECTEDMEASURE() - _rslt,
    _cy &lt;= 0 &amp;&amp; _rslt
)
</code></pre>
</div>
<div id="current-vs-last-year-1" class="section level2">
<h2>Current vs Last Year %</h2>
<pre><code>CY vs LY% = 
var _currOffset = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Sequential Fiscal Month] ) - 12
var _offsetEnd = _currOffset - 12
var _cy = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Month] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Sequential Fiscal Month] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    DIVIDE( SELECTEDMEASURE() - _rslt, ABS(_rslt) ) ,
    _cy &lt;= 0
)
</code></pre>
</div>
<div id="year-to-day" class="section level2">
<h2>Year to Day</h2>
<pre><code>YTD = 
var _currFiscYr = MAX( &#39;Calendar&#39;[FY] )
var _currDay = MAX( &#39;Calendar&#39;[Day of Fiscal Year] )
RETURN 
CALCULATE(
    SELECTEDMEASURE()
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Day of Fiscal Year] &lt;= _currDay
    , &#39;Calendar&#39;[FY] = _currFiscYr
)</code></pre>
</div>
<div id="quarter-to-day" class="section level2">
<h2>Quarter to Day</h2>
<pre><code>QTD = 
var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
var _currDay = MAX( &#39;Calendar&#39;[Day of Fiscal Year] )
RETURN 
CALCULATE(
    SELECTEDMEASURE()
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Day of Fiscal Year] &lt;= _currDay
    , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _currFiscQtr
)
</code></pre>
</div>
<div id="month-to-day" class="section level2">
<h2>Month to Day</h2>
<pre><code>MTD = 
var _currFiscMth = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _currDay = MAX( &#39;Calendar&#39;[Day of Fiscal Year] )
RETURN 
CALCULATE(
    SELECTEDMEASURE()
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Day of Fiscal Year] &lt;= _currDay
    , &#39;Calendar&#39;[Sequential Fiscal Month] = _currFiscMth
)
</code></pre>
</div>
<div id="previous-quarter-to-day" class="section level2">
<h2>Previous Quarter to Day</h2>
<pre><code>PQTD = 
var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
var _prevFiscQtr = _currFiscQtr - 1
var _dayOfFiscalQtr = MAX( &#39;Calendar&#39;[Day of Fiscal Quarter] )
// likely need to errHndl cases where largest day in fiscal qtr doesn&#39;t line up right
 
RETURN 
CALCULATE(
    SELECTEDMEASURE()
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _prevFiscQtr
    , &#39;Calendar&#39;[Day of Fiscal Quarter] &lt;= _dayOfFiscalQtr
)
</code></pre>
</div>
<div id="quarter-over-quarter-to-day" class="section level2">
<h2>Quarter Over Quarter to Day</h2>
<pre><code>QOQTD = 
var _cQTD =
    var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
    var _currDay = MAX( &#39;Calendar&#39;[Day of Fiscal Year] )
    RETURN 
    CALCULATE(
        SELECTEDMEASURE()
        , ALL( &#39;Calendar&#39; )
        , &#39;Calendar&#39;[Day of Fiscal Year] &lt;= _currDay
        , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _currFiscQtr
    )
var _pQTD =
    var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
    var _prevFiscQtr = _currFiscQtr - 1
    var _dayOfFiscalQtr = MAX( &#39;Calendar&#39;[Day of Fiscal Quarter] )
    // likely need to errHndl cases where largest day in fiscal qtr doesn&#39;t line up right
     
    RETURN 
    CALCULATE(
        SELECTEDMEASURE()
        , ALL( &#39;Calendar&#39; )
        , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _prevFiscQtr
        , &#39;Calendar&#39;[Day of Fiscal Quarter] &lt;= _dayOfFiscalQtr
    )
RETURN
    IF (
        NOT ISBLANK ( _cQTD ) &amp;&amp; NOT ISBLANK ( _pQTD ),
        _cQTD - _pQTD
    )
</code></pre>
</div>
<div id="quarter-over-quarter-to-day-1" class="section level2">
<h2>Quarter Over Quarter to Day %</h2>
<pre><code>QOQTD % = 
var _cQTD =
    var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
    var _currDay = MAX( &#39;Calendar&#39;[Day of Fiscal Year] )
    RETURN 
    CALCULATE(
        SELECTEDMEASURE()
        , ALL( &#39;Calendar&#39; )
        , &#39;Calendar&#39;[Day of Fiscal Year] &lt;= _currDay
        , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _currFiscQtr
    )
var _pQTD =
    var _currFiscQtr = MAX( &#39;Calendar&#39;[Sequential Fiscal Quarter] )
    var _prevFiscQtr = _currFiscQtr - 1
    var _dayOfFiscalQtr = MAX( &#39;Calendar&#39;[Day of Fiscal Quarter] )
    // likely need to errHndl cases where largest day in fiscal qtr doesn&#39;t line up right
     
    RETURN 
    CALCULATE(
        SELECTEDMEASURE()
        , ALL( &#39;Calendar&#39; )
        , &#39;Calendar&#39;[Sequential Fiscal Quarter] = _prevFiscQtr
        , &#39;Calendar&#39;[Day of Fiscal Quarter] &lt;= _dayOfFiscalQtr
    )
RETURN
    IF (
        NOT ISBLANK ( _cQTD ) &amp;&amp; NOT ISBLANK ( _pQTD ),
        DIVIDE( _cQTD - _pQTD , _pQTD )
    )
</code></pre>
</div>
<div id="last-month" class="section level2">
<h2>Last Month</h2>
<pre><code>LM = var _currOffset = MAX(&#39;Calendar&#39;[Fiscal Month Offset])
var _offsetBegin = MIN(&#39;Calendar&#39;[Fiscal Month Offset]) - 1
var _offsetEnd = _currOffset - 1 
var _currYr = MAX(&#39;Calendar&#39;[Fiscal Year Offset])
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES(&#39;Calendar&#39;[Date]),
    ALL(&#39;Calendar&#39;),
    &#39;Calendar&#39;[Fiscal Month Offset] &gt;= _offsetBegin &amp;&amp;
    &#39;Calendar&#39;[Fiscal Month Offset] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    _rslt,
    _currOffset &lt;= 0
)
</code></pre>
</div>
<div id="previous-period" class="section level2">
<h2>Previous Period</h2>
<pre><code>PP = 
// dynamic to fiscal month, quarter, year
var _monthsBack =
SWITCH(
    TRUE(),
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Month Offset]), 1,
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Quarter Offset]), 3,
    12
)
var _currOffset = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Sequential Fiscal Month] ) - _monthsBack
var _offsetEnd = _currOffset - _monthsBack
var _currYr = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Month] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Sequential Fiscal Month] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    _rslt,
    _currOffset &lt;= 0 || _currYr &lt;= 0
)
</code></pre>
</div>
<div id="current-vs-previous-period" class="section level2">
<h2>Current vs Previous Period</h2>
<pre><code>CP vs PP = 
// dynamic to fiscal month, quarter, year
var _monthsBack =
SWITCH(
    TRUE(),
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Month Offset]), 1,
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Quarter Offset]), 3,
    12
)
var _currOffset = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Sequential Fiscal Month] ) - _monthsBack
var _offsetEnd = _currOffset - _monthsBack
var _cy = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Month] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Sequential Fiscal Month] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    SELECTEDMEASURE() - _rslt,
    _cy &lt;= 0 &amp;&amp; _rslt
)</code></pre>
</div>
<div id="current-vs-previous-period-1" class="section level2">
<h2>Current vs Previous Period %</h2>
<pre><code>CP vs PP % = 
// dynamic to fiscal month, quarter, year
var _monthsBack =
SWITCH(
    TRUE(),
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Month Offset]), 1,
    HASONEVALUE(&#39;Calendar&#39;[Fiscal Quarter Offset]), 3,
    12
)
var _currOffset = MAX( &#39;Calendar&#39;[Sequential Fiscal Month] )
var _offsetBegin = MIN( &#39;Calendar&#39;[Sequential Fiscal Month] ) - _monthsBack
var _offsetEnd = _currOffset - _monthsBack
var _cy = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Sequential Fiscal Month] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Sequential Fiscal Month] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    DIVIDE( SELECTEDMEASURE() - _rslt, ABS(_rslt) ) ,
    _cy &lt;= 0
)
</code></pre>
</div>
<div id="same-period-last-year" class="section level2">
<h2>Same Period Last Year</h2>
<pre><code>SPLY =     CALCULATE (
        SELECTEDMEASURE (),
        SAMEPERIODLASTYEAR ( &#39;Calendar&#39;[Date] )
    )</code></pre>
</div>
<div id="last-year-week" class="section level2">
<h2>Last Year Week</h2>
<pre><code>LYWeek = var _currOffset = MAX( Calendar[Fiscal Week Offset] )
VAR _weeksofyear = MAX(Calendar[Fiscal Weeks])
var _offsetBegin = MIN( Calendar[Fiscal Week Offset] ) - _weeksofyear
var _offsetEnd = _currOffset - _weeksofyear 
var _currYr = MAX( &#39;Calendar&#39;[Fiscal Year Offset] )
var _datesOffsetPd = 
CALCULATETABLE(
    VALUES( &#39;Calendar&#39;[Date] )
    , ALL( &#39;Calendar&#39; )
    , &#39;Calendar&#39;[Fiscal Week Offset] &gt;= _offsetBegin &amp;&amp;
        &#39;Calendar&#39;[Fiscal Week Offset] &lt;= _offsetEnd
)
var _rslt = 
CALCULATE ( 
    SELECTEDMEASURE(), 
    &#39;Calendar&#39;[Date] IN _datesOffsetPd
)
RETURN
DIVIDE(
    _rslt,
    _currOffset &lt;= 0 || _currYr &lt;= 0
)</code></pre>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<pre><code>Amount QTD = 
Calculate( [measure],
KEEPFILTERS(&#39;z-CG Time Intelegence&#39;[Time Intelligence Type] = &#39;QTD&#39; ))
//Where Time Intelligence Type is a calculated group in Model View</code></pre>
</div>
</div>
<div id="time-since-last-refresh" class="section level1">
<h1>Time Since Last Refresh</h1>
<p>Let's create a blank query in power query editor and call it
‘zz-ReportRefresh’.</p>
<div id="example-1" class="section level2">
<h2>Example</h2>
<pre><code>let

    Source = #table({&quot;Dataset Refresh DT - UTC&quot;},{{DateTimeZone.FixedUtcNow()}}),

    #&quot;Changed Type&quot; = Table.TransformColumnTypes(Source,{{&quot;Dataset Refresh DT - UTC&quot;, type datetimezone}}),

    #&quot;Inserted Local Time&quot; = Table.AddColumn(#&quot;Changed Type&quot;, &quot;Dataset Refresh DT - EST&quot;, each DateTimeZone.SwitchZone([#&quot;Dataset Refresh DT - UTC&quot;],-4), type datetimezone)

in

    #&quot;Inserted Local Time&quot;
</code></pre>
<p>Let's create a measure and call it Time Since Last Refresh.</p>
<pre><code>Time Since Last Refresh =
var _currTm = UTCNOW()

var _refreshTm = MAX( &#39;zz-ReportRefresh&#39;[Dataset Refresh DT - UTC] )

var _delta = ROUNDDOWN ( DATEDIFF(_refreshTm, _currTm, MINUTE ) / 60 , 0 )

var _isMultiple = _delta &gt; 1

var _is0 = _delta = 0

return

 

SWITCH(

    TRUE(),

    _isMultiple, FORMAT( _delta, &quot;0&quot; ) &amp; &quot; hours since last dataset refresh&quot;,

    NOT _is0, FORMAT( _delta, &quot;0&quot;) &amp; &quot; hour since last dataset refresh&quot;,

    _is0, &quot;Dataset refreshed in the past hour&quot;

)</code></pre>
</div>
</div>
<div id="the-last-date-by-each-group" class="section level1">
<h1>The Last Date by Each Group</h1>
<p>Let's create a blank query in power query editor and set the Source
from existing query, in this case,
<code>Source = Inventory_wo_rank</code>. As a second step, we should
remove the all the unnecessary columns <code>#"Removed Columns"</code>
and remove all the duplicates <code>#"Removed Duplicates"</code>.</p>
<div id="example-2" class="section level2">
<h2>Example</h2>
<pre><code>let
    
    Source = Inventory_wo_rank,
    #&quot;Removed Columns&quot; = Table.RemoveColumns(Source ,{&quot;Fiscal Week Desc&quot;, &quot;Super Region&quot;, &quot;Region&quot;, &quot;Country Name&quot;, &quot;Plant &amp; Name&quot;, &quot;CFN&quot;, 
    &quot;Material&quot;, &quot;Fiscal Year&quot;, &quot;Fiscal Week Num&quot;, &quot;Month&quot;, &quot;Day&quot;,  &quot;Curreny&quot;, &quot;FY24 AOP&quot;, &quot;FY25 AOP&quot;}),
     
    #&quot;Removed Duplicates&quot; = Table.Distinct(#&quot;Removed Columns&quot;),
    #&quot;Grouped Rows&quot; = Table.Group(#&quot;Removed Duplicates&quot;, {&quot;Source&quot;}, {{&quot;All&quot;, each _, type table [Source=nullable text, FYandFW0num=nullable number]}}),
    Custom1 = Table.TransformColumns( #&quot;Grouped Rows&quot;, {{&quot;All&quot;, each  Table.AddRankColumn( _, &quot;rank&quot;, {{&quot;FYandFW0num&quot;, Order.Descending}} )}}),
    #&quot;Expanded All&quot; = Table.ExpandTableColumn(Custom1, &quot;All&quot;, {&quot;FYandFW0num&quot;, &quot;rank&quot;}, {&quot;FYandFW0num&quot;, &quot;rank&quot;}),
    #&quot;Changed Type1&quot; = Table.TransformColumnTypes(#&quot;Expanded All&quot;,{ {&quot;Source&quot;, type text}, {&quot;FYandFW0num&quot;, Int64.Type}, {&quot;rank&quot;, Int64.Type}})
in
     #&quot;Changed Type1&quot;</code></pre>
<p>In Power Query we expect to see, at this point, similar to table
below.</p>
<span class="math display">\[\begin{array}{|l|c|}
\hline
\text{Source}   &amp; \text{FYandFW0num}    \\
\hline
Group A   &amp;  \text{202448}          \\
Group A   &amp;  \text{202451}          \\
Group B   &amp;  \text{202501}          \\
Group B   &amp;  \text{202452}          \\
Group B   &amp;  \text{202453}          \\
Group C   &amp;  \text{202452}          \\
\hline
\end{array}\]</span>
<pre><code>    #&quot;Grouped Rows&quot; = Table.Group(#&quot;Removed Duplicates&quot;, {&quot;Source&quot;}, {{&quot;All&quot;, each _, type table [Source=nullable text, FYandFW0num=nullable number]}}),
    Custom1 = Table.TransformColumns( #&quot;Grouped Rows&quot;, {{&quot;All&quot;, each  Table.AddRankColumn( _, &quot;Rank&quot;, {{&quot;FYandFW0num&quot;, Order.Descending}} )}}),
    #&quot;Expanded All&quot; = Table.ExpandTableColumn(Custom1, &quot;All&quot;, {&quot;FYandFW0num&quot;, &quot;Rank&quot;}, {&quot;FYandFW0num&quot;, &quot;Rank&quot;}),
    #&quot;Changed Type1&quot; = Table.TransformColumnTypes(#&quot;Expanded All&quot;,{ {&quot;Source&quot;, type text}, {&quot;FYandFW0num&quot;, Int64.Type}, {&quot;Rank&quot;, Int64.Type}})
in
     #&quot;Changed Type1&quot;
</code></pre>
<p>Finally, we get the ranking within each Group.</p>
<span class="math display">\[\begin{array}{|l|c|c|}
\hline
\text{Source}   &amp; \text{FYandFW0num} &amp; \text{Rank}    \\
\hline
Group A   &amp;  \text{202448}   &amp;  \text{2}        \\
Group A   &amp;  \text{202451}   &amp;  \text{1}        \\
Group B   &amp;  \text{202501}   &amp;  \text{1}        \\
Group B   &amp;  \text{202452}   &amp;  \text{2}        \\
Group B   &amp;  \text{202453}   &amp;  \text{3}        \\
Group C   &amp;  \text{202452}   &amp;  \text{1}        \\
\hline
\end{array}\]</span>
<p>Current week</p>
<span class="math display">\[\begin{array}{|l|c|}
\hline
\text{FYandFW0num}   &amp; \text{Rank}  \\
\hline
\text{202448}   &amp; \text{1}        \\
\text{202451}   &amp; \text{2}        \\      
\text{202452}   &amp; \text{3}        \\       
\text{202453}   &amp; \text{4}        \\       
\text{202501}   &amp; \text{5}        \\       
\hline
\end{array}\]</span>
<pre><code>CW Amt = 
VAR CurrentFiscalWeek = MAX( &#39;Inventory&#39;[FYandFW0num] )
RETURN
CALCULATE( [Inventory],
           &#39;Inventory&#39;[FYandFW0num] = CurrentFiscalWeek )
           
PW Amt = 

CALCULATE( [Inventory],
           KEEPFILTERS( &#39;Inventory&#39;[toRank2.Rank] = MIN(&#39;Inventory&#39;[toRank2.Rank]) )           
</code></pre>
</div>
</div>
<div id="the-last-two-weeks-change" class="section level1">
<h1>The Last Two Weeks Change</h1>
<div id="example-3" class="section level2">
<h2>Example</h2>
<p>Let's set the data model first. If the dates would be
<code>FY24 WK52</code> then we should have rank the given format and use
the same methodology below.</p>
<div class="my-right-figure">
<div class="figure" style="text-align: center">
<img src="images/SampleData4Last2WeeksChange.jpg" alt=" " width="75%" />
<p class="caption">
</p>
</div>
</div>
<div class="my-right-figure">
<div class="figure" style="text-align: center">
<img src="images/Last2WeeksChange.jpg" alt=" " width="75%" />
<p class="caption">
</p>
</div>
</div>
<pre><code>CurrWeek = 
VAR TAB =
    TOPN(
        2,
        &#39;Week Slice&#39;,
        &#39;Week Slice&#39;[Week],
        DESC
    )
VAR _MAX = MAXX(TAB, &#39;Week Slice&#39;[Week])
RETURN
_MAX</code></pre>
<pre><code>PrevWeek = 
VAR TAB =
    TOPN(
        2,
        &#39;Week Slice&#39;,
        &#39;Week Slice&#39;[Week],
        DESC
    )
VAR _MIN = MINX(TAB, &#39;Week Slice&#39;[Week])
RETURN
_MIN</code></pre>
<pre><code>current Inventory = 
VAR _MAX = VALUE([CurrWeek])
VAR TotalCW =
CALCULATE(
    [Total],
    ALL(Week),
    Week[Week] = _MAX
)
RETURN
TotalCW</code></pre>
<pre><code>Total = sum(&#39;Fact&#39;[Amount])</code></pre>
<pre><code>Change = 
VAR _MAX = VALUE([CurrWeek])
VAR _MIN = VALUE([PrevWeek])
VAR TotalCW =
CALCULATE(
    [Total],
    ALL(Week),
    Week[Week] = _MAX
)
VAR TotalPW =
CALCULATE(
    [Total],
    ALL(Week),
    Week[Week] = _MIN
)
VAR Final =
TotalCW - TotalPW
RETURN
Final</code></pre>
<pre><code>Comparison = &quot;Change from week &quot;&amp;[PrevWeek] &amp;&quot; to &quot;&amp;[CurrWeek]</code></pre>
</div>
</div>
<div id="viz-ideas" class="section level1">
<h1>Viz Ideas</h1>
<div id="new-parameter" class="section level2">
<h2>New Parameter</h2>
<p>Let's create new parameters for <code>Hierarch</code>,
<code>Measure</code>, and <code>Time</code> to have multiple drop down
options into the viz.</p>
<pre><code>Table Hierarch = {
    (&quot;Business Unit&quot;, NAMEOF(&#39;dimProduct&#39;[BusinessUnit]), 0),
    (&quot;Business Sub Unit&quot;, NAMEOF(&#39;dimProduc&#39;[BusinessSubUnit]), 1),
    (&quot;Product Group&quot;, NAMEOF(&#39;dimProduct&#39;[ProductGroup]), 2),
    (&quot;Product Code&quot;, NAMEOF(&#39;dimProduct&#39;[ProductCode]), 3),
    (&quot;Global Area&quot;, NAMEOF(&#39;dimReporting&#39;[GlobalArea]), 4),
    (&quot;Geography&quot;, NAMEOF(&#39;dimReporting&#39;[Geography]), 5),
    (&quot;Country&quot;, NAMEOF(&#39;dimReporting&#39;[Country]), 6)
}</code></pre>
<pre><code>Measure =  {
    (&quot;Revenue&quot;, NAMEOF(&#39;Calculation&#39;[Revenue]), 0),
    (&quot;LY Revenue&quot;, NAMEOF(&#39;Calculation&#39;[LYRevenue]), 1),
    (&quot;AOP&quot;, NAMEOF(&#39;Calculation&#39;[AOP]), 2),
    (&quot;Revenue vs AOP&quot;, NAMEOF(&#39;Calculation&#39;[RevenuevsAOP]), 3)
}</code></pre>
<pre><code>Fiscal Timeline = {
    (&quot;Year&quot;, NAMEOF(&#39;Calendar&#39;[Fiscal YR]), 0),
    (&quot;Quarter&quot;, NAMEOF(&#39;Calendar&#39;[Fiscal Quarter-Year]), 1),
    (&quot;Month&quot;, NAMEOF(&#39;Calendar&#39;[FY Month]), 2),
    (&quot;Week&quot;, NAMEOF(&#39;Calendar&#39;[Fiscal Week]), 3)
}</code></pre>
<p>The new parameters help to create the table with ease and provides
more filtering option.</p>
<div class="my-right-figure">
<div class="figure" style="text-align: center">
<img src="images/revenuetab.png" alt=" " width="90%" />
<p class="caption">
</p>
</div>
</div>
</div>
<div id="book-marks-example" class="section level2">
<h2>Book Marks Example</h2>
</div>
<div id="tool-tips-example" class="section level2">
<h2>Tool Tips Example</h2>
</div>
</div>
<div id="rls" class="section level1">
<h1>RLS</h1>
<p>Following link may give an idea of how to set up
<a href="https://learn.microsoft.com/en-us/fabric/security/service-admin-row-level-security" target="_blank">RLS</a>.
Yet, I will show you a better way.</p>
<div id="fact_rls" class="section level2">
<h2>Fact_RLS</h2>
<p>Fact_RLS dataflow as:</p>
<span class="math display">\[\begin{array}{|l|c|c|}
\hline
\text{User}   &amp; \text{Email Address} &amp; \text{Access} &amp;
\text{Region}&amp; \text{RPT ID}&amp; \text{Access Status}   \\
\hline
User1   &amp;  \text{user1@email.com}   &amp;\text{Admin}  &amp;\text{}               &amp;\text{}    &amp;\text{Access
Assigned} \\
User2   &amp;  \text{user2@email.com}   &amp;\text{Admin}  &amp;\text{}               &amp;\text{}    &amp;\text{Access
Assigned} \\
User3   &amp;  \text{user3@email.com}   &amp;\text{Region}
&amp;\text{Americas}       &amp;\text{}    &amp;\text{Access Assigned}
\\
User4   &amp;  \text{user4@email.com}   &amp;\text{Region}
&amp;\text{Asia Pasific}   &amp;\text{}    &amp;\text{Access Assigned}
\\
User5   &amp;  \text{user5@email.com}   &amp;\text{Region}
&amp;\text{EMEA}           &amp;\text{}    &amp;\text{Access Assigned}
\\
User6   &amp;  \text{user6@email.com}   &amp;\text{Region}
&amp;\text{GOCS}           &amp;\text{}    &amp;\text{Access Assigned}
\\
User7   &amp;  \text{user7@email.com}   &amp;\text{Region}
&amp;\text{Greater China}  &amp;\text{}    &amp;\text{Access Assigned}
\\
User8   &amp;  \text{user8@email.com}   &amp;\text{Region}
&amp;\text{Greater China}  &amp;\text{}    &amp;\text{Access Assigned}
\\
User9   &amp;  \text{user9@email.com}   &amp;\text{RPT ID}
&amp;\text{}               &amp;\text{USA} &amp;\text{Access Assigned}
\\
User10  &amp;  \text{user10@email.com}  &amp;\text{RPT ID}
&amp;\text{}               &amp;\text{TUK} &amp;\text{Access Assigned}
\\


\hline
\end{array}\]</span>
<p>From the Modeling tab, select Manage Roles and add a new role as
follow. For <code>ADMIN</code> role set up NO FILTER.</p>
<p>Keep in mine, the Fact_RLS dataflow has no relationship with other
tables in the data modelling. Yet <code>dimReporting</code> has
relationship with other tables. For other Roles set up the filter as
follows;</p>
<p><code>BUSINESS PARTNER</code></p>
<pre><code>[Finance Business Partner] #A column name in the Selected Table (let&#39;s assume it is dimReporting table)
    IN CALCULATETABLE (
        VALUES ( &#39;Fact_RLS&#39;[User] ),
                 &#39;Fact_RLS&#39;[Email Address]
        = USERNAME ()
    )</code></pre>
<p><code>FINANCIAL ANALYST</code></p>
<pre><code>[Analyst] #A column name in the Selected Table (let&#39;s assume it is dimReporting table)
    IN CALCULATETABLE (
        VALUES ( &#39;Fact_RLS&#39;[User] ),
                 &#39;Fact_RLS&#39;[Email Address]
        = USERNAME ()
    )</code></pre>
<p><code>RPT ID</code></p>
<pre><code>[Reporting Location ID] #A column name in the Selected Table (let&#39;s assume it is dimReporting table)
    IN CALCULATETABLE (
        VALUES ( &#39;Fact_RLS&#39;[RPT ID] ),
                 &#39;Fact_RLS&#39;[Email Address]
        = USERNAME ()
    )</code></pre>
<p><code>SENIOR LEADERSHIP</code></p>
<pre><code>[Senior Leadership Team] #A column name in the Selected Table (let&#39;s assume it is dimReporting table)
    IN CALCULATETABLE (
        VALUES ( Fact_RLS[User] ),
                 Fact_RLS[Email Address]
        = USERNAME ()
    )</code></pre>
</div>
</div>
<div id="fact-fx" class="section level1">
<h1>Fact FX</h1>
<p>To be able to produce before ‘Fact FX’ data flow we need to create a
few data flows.</p>
<pre><code>let
   
    Source = let
      Source = Excel.Workbook(File.Contents(&quot;.\dimFX.xlsx&quot;), null, true),
    dimFX_Table = Source{[Item=&quot;dimFX&quot;,Kind=&quot;Table&quot;]}[Data],
    #&quot;Changed Type&quot; = Table.TransformColumnTypes(dimFX_Table,{{&quot;Currency Code&quot;, type text}, {&quot;Country&quot;, type text}, {&quot;Currency Conversion Method&quot;, type text}, {&quot;FY23 AOP&quot;, type number}, {&quot;FY24 AOP&quot;, type number}, {&quot;FY25 AOP&quot;, type number}, 
    {&quot;FY23 May M-BS&quot;, type number}, {&quot;FY23 Jun M-BS&quot;, type number}, {&quot;FY23 Jul M-BS&quot;, type number}, {&quot;FY23 Aug M-BS&quot;, type number}, {&quot;FY23 Sep M-BS&quot;, type number}, {&quot;FY23 Oct M-BS&quot;, type number}, {&quot;FY23 Nov M-BS&quot;, type number}, 
    {&quot;FY23 Dec M-BS&quot;, type number}, {&quot;FY23 Jan M-BS&quot;, type number}, {&quot;FY23 Feb M-BS&quot;, type number}, {&quot;FY23 Mar M-BS&quot;, type number}, {&quot;FY23 Apr M-BS&quot;, type number}, {&quot;FY23 May M-PL&quot;, type number}, {&quot;FY23 Jun M-PL&quot;, type number},
     {&quot;FY23 Jul M-PL&quot;, type number}, {&quot;FY23 Aug M-PL&quot;, type number}, {&quot;FY23 Sep M-PL&quot;, type number}, {&quot;FY23 Oct M-PL&quot;, type number}, {&quot;FY23 Nov M-PL&quot;, type number}, {&quot;FY23 Dec M-PL&quot;, type number}, {&quot;FY23 Jan M-PL&quot;, type number}, 
     {&quot;FY23 Feb M-PL&quot;, type number}, {&quot;FY23 Mar M-PL&quot;, type number}, {&quot;FY23 Apr M-PL&quot;, type number}, {&quot;FY24 May M-BS&quot;, type number}, {&quot;FY24 Jun M-BS&quot;, type number}, {&quot;FY24 Jul M-BS&quot;, type number}, {&quot;FY24 Aug M-BS&quot;, type number},
      {&quot;FY24 Sep M-BS&quot;, type number}, {&quot;FY24 Oct M-BS&quot;, type number}, {&quot;FY24 Nov M-BS&quot;, type number}, {&quot;FY24 Dec M-BS&quot;, type number}, {&quot;FY24 Jan M-BS&quot;, type number}, {&quot;FY24 Feb M-BS&quot;, type number}, {&quot;FY24 Mar M-BS&quot;, type number}, 
      {&quot;FY24 Apr M-BS&quot;, type number}, {&quot;FY25 May M-BS&quot;, type number}, {&quot;FY25 Jun M-BS&quot;, type number}, {&quot;FY25 Jul M-BS&quot;, type number}, {&quot;FY25 Aug M-BS&quot;, type number}, {&quot;FY25 Sep M-BS&quot;, type number}, {&quot;FY25 Oct M-BS&quot;, type number}, 
      {&quot;FY25 Nov M-BS&quot;, type number}, {&quot;FY25 Dec M-BS&quot;, type number}, {&quot;FY25 Jan M-BS&quot;, type number}, {&quot;FY25 Feb M-BS&quot;, type number}, {&quot;FY25 Mar M-BS&quot;, type number}, {&quot;FY25 Apr M-BS&quot;, type any}, {&quot;FY24 May M-PL&quot;, type number},
       {&quot;FY24 Jun M-PL&quot;, type number}, {&quot;FY24 Jul M-PL&quot;, type number}, {&quot;FY24 Aug M-PL&quot;, type number}, {&quot;FY24 Sep M-PL&quot;, type number}, {&quot;FY24 Oct M-PL&quot;, type number}, {&quot;FY24 Nov M-PL&quot;, type number}, {&quot;FY24 Dec M-PL&quot;, type number}, 
       {&quot;FY24 Jan M-PL&quot;, type number}, {&quot;FY24 Feb M-PL&quot;, type number}, {&quot;FY24 Mar M-PL&quot;, type number}, {&quot;FY24 Apr M-PL&quot;, type number}, {&quot;FY25 May M-PL&quot;, type number}, {&quot;FY25 Jun M-PL&quot;, type number}, {&quot;FY25 Jul M-PL&quot;, type number}, 
       {&quot;FY25 Aug M-PL&quot;, type number}, {&quot;FY25 Sep M-PL&quot;, type number}, {&quot;FY25 Oct M-PL&quot;, type number}, {&quot;FY25 Nov M-PL&quot;, type number}, {&quot;FY25 Dec M-PL&quot;, type number}, {&quot;FY25 Jan M-PL&quot;, type number}, {&quot;FY25 Feb M-PL&quot;, type number}, 
       {&quot;FY25 Mar M-PL&quot;, type number}, {&quot;FY25 Apr M-PL&quot;, type number}})

in    
    #&quot;Changed Type&quot;,
    #&quot;Removed Duplicates&quot; = Table.Distinct(Source, {&quot;Currency Code&quot;, &quot;Country&quot;, &quot;Currency Conversion Method&quot;}),
  #&quot;Removed columns&quot; = Table.RemoveColumns(#&quot;Removed Duplicates&quot;, {&quot;FY23 AOP&quot;, &quot;FY24 AOP&quot;}),
  #&quot;Duplicated column 3&quot; = Table.DuplicateColumn(#&quot;Removed columns&quot;, &quot;FY25 AOP&quot;, &quot;FY24 AOP&quot;),
  #&quot;Duplicated column&quot; = Table.DuplicateColumn(#&quot;Duplicated column 3&quot;, &quot;FY25 AOP&quot;, &quot;FY23 AOP&quot;),
  #&quot;Duplicated column 1&quot; = Table.DuplicateColumn(#&quot;Duplicated column&quot;, &quot;FY25 AOP&quot;, &quot;FY22 AOP&quot;),
  #&quot;Duplicated column 2&quot; = Table.DuplicateColumn(#&quot;Duplicated column 1&quot;, &quot;FY22 AOP&quot;, &quot;FY21 AOP&quot;),
    UnpivotFXRate = Table.UnpivotOtherColumns(#&quot;Duplicated column 2&quot;, {&quot;Currency Conversion Method&quot;, &quot;Country&quot;, &quot;Currency Code&quot;}, &quot;Attribute&quot;, &quot;FX Rate&quot;),
    AddFXScenario = Table.AddColumn(UnpivotFXRate, &quot;FX Scenario&quot;, each if Text.Contains([Attribute], &quot;AOP&quot;) then &quot;AOP&quot; else &quot;Actual&quot;, type text),
    #&quot;Inserted Text After Delimiter&quot; = Table.AddColumn(AddFXScenario, &quot;FX Type&quot;, each if Text.Contains([Attribute],&quot;AOP&quot;) then &quot;AOP&quot; else Text.AfterDelimiter([Attribute], &quot;-&quot;), type text),
    #&quot;Inserted Text Before Delimiter&quot; = Table.AddColumn(#&quot;Inserted Text After Delimiter&quot;, &quot;Date_Stg&quot;, each if Text.Contains([Attribute],&quot;AOP&quot;) then Text.BeforeDelimiter([Attribute], &quot;AOP&quot;) &amp; &quot;May&quot; else Text.BeforeDelimiter([Attribute], &quot; M-&quot;), type text),
    #&quot;Extracted Text After Delimiter&quot; = Table.TransformColumns(#&quot;Inserted Text Before Delimiter&quot;, {{&quot;Date_Stg&quot;, each Text.AfterDelimiter(_, &quot;FY&quot;), type text}}),
    #&quot;Added Custom1&quot; = Table.AddColumn(#&quot;Extracted Text After Delimiter&quot;, &quot;Date_Stg2&quot;, each &quot;15-&quot; &amp; Text.End([Date_Stg],3) &amp; &quot;-&quot; &amp; Text.Start([Date_Stg],2)),
    #&quot;Changed Type&quot; = Table.TransformColumnTypes(#&quot;Added Custom1&quot;,{{&quot;Date_Stg2&quot;, type date}}),
    #&quot;Added Custom2&quot; = Table.AddColumn(#&quot;Changed Type&quot;, &quot;Date&quot;, each if Text.Contains([Attribute], &quot;AOP&quot;) 
then List.Generate(()=&gt;[x=Date.AddYears( [Date_Stg2], -1 ),i=0], each [i]&lt;12, each [i=[i]+1,x=Date.AddMonths([x],1)], each [x]) // creates 12 months of AOP data
else if Date.Month([Date_Stg2]) &gt; 4 
then List.Dates(Date.AddYears( [Date_Stg2], -1 ),1,#duration(1,0,0,0)) // one item list, transposing year back by 1
else List.Dates([Date_Stg2],1,#duration(1,0,0,0))) // one item list
,
    #&quot;Expanded Date&quot; = Table.ExpandListColumn(#&quot;Added Custom2&quot;, &quot;Date&quot;),
    #&quot;Changed Type1&quot; = Table.TransformColumnTypes(#&quot;Expanded Date&quot;,{{&quot;Date&quot;, type date}}),
    #&quot;Merged Queries&quot; = Table.NestedJoin(#&quot;Changed Type1&quot;, {&quot;Date&quot;}, #&quot;Fiscal Date&quot;, {&quot;Date&quot;}, &quot;Fiscal Date&quot;, JoinKind.LeftOuter),
    #&quot;Expanded Fiscal Date&quot; = Table.ExpandTableColumn(#&quot;Merged Queries&quot;, &quot;Fiscal Date&quot;, {&quot;Fiscal Month Start&quot;, &quot;Fiscal Month End&quot;}, {&quot;Fiscal Month Start&quot;, &quot;Fiscal Month End&quot;}),
    #&quot;Added Custom&quot; = Table.AddColumn(#&quot;Expanded Fiscal Date&quot;, &quot;Fiscal Date&quot;, each {Number.From([Fiscal Month Start])..Number.From([Fiscal Month End])}),
    #&quot;Expanded Custom&quot; = Table.ExpandListColumn(#&quot;Added Custom&quot;, &quot;Fiscal Date&quot;),
    #&quot;Changed Type2&quot; = Table.TransformColumnTypes(#&quot;Expanded Custom&quot;,{{&quot;FX Rate&quot;, type number}, {&quot;Fiscal Date&quot;, type date}}),
    #&quot;Removed Columns1&quot; = Table.RemoveColumns(#&quot;Changed Type2&quot;,{&quot;Date&quot;, &quot;Fiscal Month Start&quot;, &quot;Fiscal Month End&quot;, &quot;Date_Stg&quot;, &quot;Date_Stg2&quot;}),
    #&quot;Renamed Columns&quot; = Table.RenameColumns(#&quot;Removed Columns1&quot;,{{&quot;Fiscal Date&quot;, &quot;Date&quot;}})
in
    #&quot;Renamed Columns&quot;</code></pre>
<div id="fiscal-month-end" class="section level2">
<h2>Fiscal Month End</h2>
<pre><code>let
  Source = dimCalendar,
  #&quot;Removed Duplicates&quot; = Table.Distinct(Source, {&quot;Fiscal Year&quot;}),
  #&quot;Choose columns&quot; = Table.SelectColumns(#&quot;Removed Duplicates&quot;, {&quot;Fiscal Year&quot;, &quot;Fiscal Month 01 End&quot;, &quot;Fiscal Month 02 End&quot;, &quot;Fiscal Month 03 End&quot;, &quot;Fiscal Month 04 End&quot;, &quot;Fiscal Month 05 End&quot;, &quot;Fiscal Month 06 End&quot;, &quot;Fiscal Month 07 End&quot;, &quot;Fiscal Month 08 End&quot;, &quot;Fiscal Month 09 End&quot;, &quot;Fiscal Month 10 End&quot;, &quot;Fiscal Month 11 End&quot;, &quot;Fiscal Month 12 End&quot;}),
  #&quot;Unpivoted Columns3&quot; = Table.UnpivotOtherColumns(#&quot;Choose columns&quot;, {&quot;Fiscal Year&quot;}, &quot;Attribute&quot;, &quot;Value&quot;),
  #&quot;Renamed Columns&quot; = Table.RenameColumns(#&quot;Unpivoted Columns3&quot;, {{&quot;Value&quot;, &quot;Fiscal Month End&quot;}}),
  #&quot;Added Conditional Column&quot; = Table.AddColumn(#&quot;Renamed Columns&quot;, &quot;Fiscal Month&quot;, each if [Attribute] = &quot;Fiscal Month 01 End&quot; then &quot;May&quot; else if [Attribute] = &quot;Fiscal Month 02 End&quot; then &quot;Jun&quot; else if [Attribute] = &quot;Fiscal Month 03 End&quot; then &quot;Jul&quot; else if [Attribute] = &quot;Fiscal Month 04 End&quot; then &quot;Aug&quot; else if [Attribute] = &quot;Fiscal Month 05 End&quot; then &quot;Sep&quot; else if [Attribute] = &quot;Fiscal Month 06 End&quot; then &quot;Oct&quot; else if [Attribute] = &quot;Fiscal Month 07 End&quot; then &quot;Nov&quot; else if [Attribute] = &quot;Fiscal Month 08 End&quot; then &quot;Dec&quot; else if [Attribute] = &quot;Fiscal Month 09 End&quot; then &quot;Jan&quot; else if [Attribute] = &quot;Fiscal Month 10 End&quot; then &quot;Feb&quot; else if [Attribute] = &quot;Fiscal Month 11 End&quot; then &quot;Mar&quot; else if [Attribute] = &quot;Fiscal Month 12 End&quot; then &quot;Apr&quot; else null),
  #&quot;Inserted Merged Column&quot; = Table.AddColumn(#&quot;Added Conditional Column&quot;, &quot;Fiscal Month Year&quot;, each Text.Combine({[Fiscal Month], [Fiscal Year]}, &quot;-&quot;), type text),
  #&quot;Removed Columns&quot; = Table.RemoveColumns(#&quot;Inserted Merged Column&quot;, {&quot;Attribute&quot;}),
  #&quot;Transform columns&quot; = Table.TransformColumnTypes(#&quot;Removed Columns&quot;, {{&quot;Fiscal Month&quot;, type text}}),
  #&quot;Replace errors&quot; = Table.ReplaceErrorValues(#&quot;Transform columns&quot;, {{&quot;Fiscal Month&quot;, null}})
in
  #&quot;Replace errors&quot;</code></pre>
</div>
<div id="fiscal-month-start" class="section level2">
<h2>Fiscal Month Start</h2>
<pre><code>let
  Source = dimCalendar,
  #&quot;Removed Duplicates&quot; = Table.Distinct(Source, {&quot;Fiscal Year&quot;}),
    #&quot;Choose columns&quot; = Table.SelectColumns(#&quot;Removed Duplicates&quot;,{&quot;Fiscal Year Start&quot;, &quot;Fiscal Year&quot;, &quot;Fiscal Month 01 End&quot;, &quot;Fiscal Month 02 End&quot;, &quot;Fiscal Month 03 End&quot;, &quot;Fiscal Month 04 End&quot;, &quot;Fiscal Month 05 End&quot;, &quot;Fiscal Month 06 End&quot;, &quot;Fiscal Month 07 End&quot;, &quot;Fiscal Month 08 End&quot;, &quot;Fiscal Month 09 End&quot;, &quot;Fiscal Month 10 End&quot;, &quot;Fiscal Month 11 End&quot;}),
    #&quot;Unpivoted Columns3&quot; = Table.UnpivotOtherColumns(#&quot;Choose columns&quot;, {&quot;Fiscal Year&quot;}, &quot;Attribute&quot;, &quot;Value&quot;),
    #&quot;Changed Type&quot; = Table.TransformColumnTypes(#&quot;Unpivoted Columns3&quot;,{{&quot;Value&quot;, Int64.Type}}),
    #&quot;Added Conditional Column1&quot; = Table.AddColumn(#&quot;Changed Type&quot;, &quot;Fiscal Month Start&quot;, each if [Attribute] = &quot;Fiscal Year Start&quot; then [Value] else [Value]+1),
    #&quot;Added Conditional Column&quot; = Table.AddColumn(#&quot;Added Conditional Column1&quot;, &quot;Fiscal Month&quot;, each if [Attribute] = &quot;Fiscal Month 01 End&quot; then &quot;Jun&quot; else if [Attribute] = &quot;Fiscal Month 02 End&quot; then &quot;Jul&quot; else if [Attribute] = &quot;Fiscal Month 03 End&quot; then &quot;Aug&quot; else if [Attribute] = &quot;Fiscal Month 04 End&quot; then &quot;Sep&quot; else if [Attribute] = &quot;Fiscal Month 05 End&quot; then &quot;Oct&quot; else if [Attribute] = &quot;Fiscal Month 06 End&quot; then &quot;Nov&quot; else if [Attribute] = &quot;Fiscal Month 07 End&quot; then &quot;Dec&quot; else if [Attribute] = &quot;Fiscal Month 08 End&quot; then &quot;Jan&quot; else if [Attribute] = &quot;Fiscal Month 09 End&quot; then &quot;Feb&quot; else if [Attribute] = &quot;Fiscal Month 10 End&quot; then &quot;Mar&quot; else if [Attribute] = &quot;Fiscal Month 11 End&quot; then &quot;Apr&quot; else if [Attribute] = &quot;Fiscal Year Start&quot; then &quot;May&quot; else null),
    #&quot;Inserted Merged Column&quot; = Table.AddColumn(#&quot;Added Conditional Column&quot;, &quot;Fiscal Month Year&quot;, each Text.Combine({[#&quot;Fiscal Month&quot;], [Fiscal Year]}, &quot;-&quot;), type text),
    #&quot;Removed Columns1&quot; = Table.RemoveColumns(#&quot;Inserted Merged Column&quot;,{&quot;Attribute&quot;, &quot;Value&quot;}),
    #&quot;Changed Type1&quot; = Table.TransformColumnTypes(#&quot;Removed Columns1&quot;,{{&quot;Fiscal Month Start&quot;, type date}, {&quot;Fiscal Month&quot;, type text}})
in
    #&quot;Changed Type1&quot;</code></pre>
</div>
<div id="fiscal-date" class="section level2">
<h2>Fiscal Date</h2>
<pre><code>let
  Source = Table.NestedJoin(#&quot;Fiscal Month End&quot;, {&quot;Fiscal Month Year&quot;}, #&quot;Fiscal Month Start&quot;, {&quot;Fiscal Month Year&quot;}, &quot;Fiscal Month Start&quot;, JoinKind.LeftOuter),
  #&quot;Expanded Fiscal Month Start&quot; = Table.ExpandTableColumn(Source, &quot;Fiscal Month Start&quot;, {&quot;Fiscal Month Start&quot;}, {&quot;Fiscal Month Start&quot;}),
  #&quot;Merged Queries&quot; = Table.NestedJoin(#&quot;Expanded Fiscal Month Start&quot;, {&quot;Fiscal Month Year&quot;}, Calendar, {&quot;Fiscal Month-Year&quot;}, &quot;Calendar&quot;, JoinKind.LeftOuter),
  #&quot;Expanded Calendar&quot; = Table.ExpandTableColumn(#&quot;Merged Queries&quot;, &quot;Calendar&quot;, {&quot;Date&quot;}, {&quot;Date&quot;}),
  #&quot;Transform columns&quot; = Table.TransformColumnTypes(#&quot;Expanded Calendar&quot;, {{&quot;Fiscal Month&quot;, type text}}),
  #&quot;Replace errors&quot; = Table.ReplaceErrorValues(#&quot;Transform columns&quot;, {{&quot;Fiscal Month&quot;, null}})
in
  #&quot;Replace errors&quot;</code></pre>
</div>
</div>
<div id="currency-rate-conversion" class="section level1">
<h1>Currency Rate Conversion</h1>
<div id="fact-fx-1" class="section level2">
<h2>Fact FX</h2>
<p>‘Fact FX’ dataflow as:</p>
<span class="math display">\[\begin{array}{|l|l|c|l|l|l|l|l|l|}
\hline
\text{Currency Code}   &amp; \text{Country} &amp; \text{Conversion
Method} &amp; \text{Attribute} &amp; \text{FX Rate}&amp; \text{FX
Scenario}&amp; \text{FX Type}&amp; \text{Date} \\
\hline
\text{USD}  &amp; \text{United States}  &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{1}              &amp;
\text{AOP}      &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{USD}  &amp; \text{United States}  &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{1}            &amp;
\text{Actual}     &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{USD}  &amp; \text{United States}  &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{1}            &amp;
\text{Actual}     &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{EUR}  &amp; \text{Europe}         &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{1.05}         &amp;
\text{AOP}        &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{EUR}  &amp; \text{Europe}         &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{1.085198971}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{EUR}  &amp; \text{Europe}         &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{1.070354394}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{JPY}  &amp; \text{Japan}          &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{0.006896552}  &amp;
\text{AOP}        &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{JPY}  &amp; \text{Japan}          &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{0.006401844}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{JPY}  &amp; \text{Japan}          &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{0.006460157}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{GBP}  &amp; \text{United Kingdom} &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{1.27}         &amp;
\text{AOP}      &amp; \text{AOP}  &amp; \text{5/15/2024}\\
\text{GBP}  &amp; \text{United Kingdom} &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{1.271051795}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{GBP}  &amp; \text{United Kingdom} &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{1.244895927}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{CHF}  &amp; \text{Switzerland}    &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{1.111111111}  &amp;
\text{AOP}        &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{CHF}  &amp; \text{Switzerland}    &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{1.09751413}   &amp;
\text{Actual}     &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{CHF}  &amp; \text{Switzerland}    &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{1.096791884}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{CAD}  &amp; \text{Canada}         &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{0.735294118}  &amp;
\text{AOP}        &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{CAD}  &amp; \text{Canada}         &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{0.732412934}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{CAD}  &amp; \text{Canada}         &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{0.732010834}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\text{AUD}  &amp; \text{Australia}      &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{0.675}          &amp;
\text{AOP}      &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{AUD}  &amp; \text{Australia}      &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{0.666600007}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{AUD}  &amp; \text{Australia}      &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{0.648701947}    &amp;
\text{Actual}   &amp; \text{PL}   &amp; \text{5/15/2024}\\
\text{AED}  &amp; \text{United Arab}    &amp; \text{USD per LC} &amp;
\text{FY25 AOP}         &amp; \text{0.272257011}  &amp;
\text{AOP}        &amp; \text{AOP}    &amp; \text{5/15/2024}\\
\text{AED}  &amp; \text{United Arab}    &amp; \text{USD per LC} &amp;
\text{FY25 May M-BS}  &amp; \text{0.272264423}    &amp;
\text{Actual}   &amp; \text{BS}     &amp; \text{5/15/2024}\\
\text{AED}  &amp; \text{United Arab}    &amp; \text{USD per LC} &amp;
\text{FY25 May M-PL}  &amp; \text{0.272286663}    &amp;
\text{Actual}   &amp; \text{PL}     &amp; \text{5/15/2024}\\
\hline
\end{array}\]</span>
</div>
<div id="dimcurrency" class="section level2">
<h2>dimCurrency</h2>
<p>‘dimCurrency’ data flow as:</p>
<span class="math display">\[\begin{array}{|l|c|}
\hline
\text{Currency Code}   &amp; \text{Country}  \\
\hline
\text{USD}   &amp; \text{United States}    \\
\text{EUR}   &amp; \text{Europe}           \\      
\text{JPY}   &amp; \text{Japan}            \\       
\text{GBP}   &amp; \text{United Kingdom}   \\       
\text{CHF}   &amp; \text{Switzerland}      \\   
\text{CAD}   &amp; \text{Canada}           \\  
\text{AUD}   &amp; \text{Australia}        \\  
\text{AED}   &amp; \text{United Arab}      \\  
\text{CNY}   &amp; \text{China}            \\  
\hline
\end{array}\]</span>
</div>
<div id="fact_aop" class="section level2">
<h2>Fact_AOP</h2>
<p>‘Fact_AOP’ data flow as:</p>
<span class="math display">\[\begin{array}{|l|l|}
\hline
\text{Data Source}   &amp; \text{RPT ID} &amp; \text{G/L Account}&amp;
\text{Amount}&amp; \text{Date}&amp; \text{Currency}&amp; \text{Amount
Type}&amp; \text{Scenario}&amp; \text{Product ID} \\
\hline
\text{filename.xlsx}   &amp; \text{TMX}   &amp; \text{5340900}   &amp;
\text{11538}    &amp; \text{5/15/2024}   &amp; \text{USD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BEM}   &amp; \text{5265000}   &amp;
\text{347659}   &amp; \text{5/15/2024}   &amp; \text{USD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{BEM}   &amp; \text{5280000}   &amp;
\text{106681}   &amp; \text{5/15/2024}   &amp; \text{USD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BEM}   &amp; \text{5210900}   &amp;
\text{682041}   &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P123}\\
\text{filename.xlsx}   &amp; \text{BEM}   &amp; \text{5225000}   &amp;
\text{796059}   &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5265000}   &amp;
\text{17520}    &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5280000}   &amp;
\text{47083}    &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5260003}   &amp;
\text{24504}    &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P127}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5210900}   &amp;
\text{86324}    &amp; \text{5/15/2024}   &amp; \text{EUR}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5225000}   &amp;
\text{152606}   &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P129}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5010900}   &amp;
\text{30000}    &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P130}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5110900}   &amp;
\text{60000}    &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BHP}   &amp; \text{5004000}   &amp;
\text{70000}    &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{BLS}   &amp; \text{5265000}   &amp;
\text{95389}    &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P123}\\
\text{filename.xlsx}   &amp; \text{BLS}   &amp; \text{5260003}   &amp;
\text{27230}    &amp; \text{5/15/2024}   &amp; \text{JPY}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P134}\\
\text{filename.xlsx}   &amp; \text{BLS}   &amp; \text{5210900}   &amp;
\text{51732}    &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{BLS}   &amp; \text{5225000}   &amp;
\text{114307}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P136}\\
\text{filename.xlsx}   &amp; \text{BLS}   &amp; \text{5110900}   &amp;
\text{22460}    &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5265000}   &amp;
\text{185465}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P123}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5280000}   &amp;
\text{114718}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P139}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5260003}   &amp;
\text{369725}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5210900}   &amp;
\text{339158}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P141}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5225000}   &amp;
\text{819388}   &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{CMG}   &amp; \text{5110900}   &amp;
\text{10000}    &amp; \text{5/15/2024}   &amp; \text{GBP}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P143}\\
\text{filename.xlsx}   &amp; \text{EHW}   &amp; \text{5350000}   &amp;
\text{94203}    &amp; \text{5/15/2024}   &amp; \text{CHF}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{EHW}   &amp; \text{5340900}   &amp;
\text{28086}    &amp; \text{5/15/2024}   &amp; \text{CHF}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P121}\\
\text{filename.xlsx}   &amp; \text{TBE}   &amp; \text{5340900}   &amp;
\text{11517}    &amp; \text{5/15/2024}   &amp; \text{CAD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P123}\\
\text{filename.xlsx}   &amp; \text{TFR}   &amp; \text{5340900}   &amp;
\text{40110}    &amp; \text{5/15/2024}   &amp; \text{CAD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P120}\\
\text{filename.xlsx}   &amp; \text{TIL}   &amp; \text{5340900}   &amp;
\text{244978}   &amp; \text{5/15/2024}   &amp; \text{CAD}   &amp;
\text{Currency}   &amp; \text{AOP}   &amp; \text{P123}\\
\hline
\end{array}\]</span>
</div>
<div id="usd-currency-conversion" class="section level2">
<h2>USD Currency Conversion</h2>
<pre><code>Base Measure = SUM(&#39;Fact_AOP&#39;[Amount])


Sum@AOP =
VAR _AggregatedAmountInCurrency =
    ADDCOLUMNS (
        SUMMARIZE (
            &#39;Fact_AOP&#39;,
            &#39;Calendar&#39;[Date],
            &#39;dimCurrency&#39;[Currency Code]
        ),
        &quot;@AmountInCurrency&quot;, [Base Measure],
        &quot;@Rate&quot;, CALCULATE(
                    MAX( &#39;factFX&#39;[FX Rate] ),
                    KEEPFILTERS( &#39;factFX&#39;[FX Type] = &quot;AOP&quot; ),
                    ALLEXCEPT(&#39;Calendar&#39;, &#39;Calendar&#39;[Date])
                )
    )
VAR _Result =
    SUMX (
        _AggregatedAmountInCurrency,
        [@AmountInCurrency] * COALESCE( [@Rate], IF( &#39;dimCurrency&#39;[Currency Code] = &quot;USD&quot; , 1) )
    )
RETURN
    _Result</code></pre>
</div>
</div>
<div id="data-modeling" class="section level1">
<h1>Data Modeling</h1>
<div id="bridge-table" class="section level2">
<h2>Bridge Table</h2>
<p>Bridge tables are used to remove multi-multi relationship.</p>
<div class="my-right-figure">
<div class="figure" style="text-align: center">
<img src="images/datamodelling.png" alt=" " width="75%" />
<p class="caption">
</p>
</div>
</div>
</div>
<div id="data-source" class="section level2">
<h2>Data Source</h2>
<p>This calculated table appends the multiple fact tables.</p>
<pre><code>Data Sources = 
var _base =
SUMMARIZE(
    UNION(
        SUMMARIZE( 
            SELECTCOLUMNS( &#39;Fact_Financials&#39;, &quot;Data Source&quot;, &#39;Fact_Financials&#39;[Data Source] ),
            [Data Source]
        )
        , // copy paste this pattern when adding new fact tables as they appear
        SUMMARIZE( // SNOWFLAKE GL_DTL carries transactional data from Snowflake 
            SELECTCOLUMNS( &#39;Fact_AOP&#39;, &quot;Data Source&quot;, &#39;Fact_AOP&#39;[Data Source] ),
            [Data Source]
        )

    )
    , [Data Source]//, [Scenarios]
)
var _addCategories =
    ADDCOLUMNS(
        _base
        , &quot;Input or Backend&quot;
        , SWITCH( 
            TRUE(),
            CONTAINSSTRING( [Data Source], &quot;Input&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;.xlsx&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;CMR&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;BW_Inventory&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;Corporate S4 Reconciliation Input&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;Greater China S4 Revenue Adj&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;Americas S4 Revenue Adj&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;EMEA S4 Revenue Adj&quot; ), &quot;Input&quot;,
            CONTAINSSTRING( [Data Source], &quot;SNOWFLAKE&quot; ), &quot;Snowflake&quot;,
            CONTAINSSTRING( [Data Source], &quot;SAP&quot; ), &quot;SAP S4&quot;,
            CONTAINSSTRING( [Data Source], &quot;S4&quot; ), &quot;SAP S4&quot;,
            CONTAINSSTRING( [Data Source], &quot;Freight Review&quot; ), &quot;Freight&quot;,
            CONTAINSSTRING( [Data Source], &quot;Market Model&quot; ), &quot;SAP S4&quot;,
            &quot;Input&quot;
        )
        , &quot;Data Source Category&quot;
        , SWITCH(
            TRUE(),
            CONTAINSSTRING( [Data Source], &quot;SGM&quot; ), &quot;SGM&quot;,
            CONTAINSSTRING( [Data Source], &quot;GL_DTL&quot; ), &quot;Weekly Sales&quot;, // may modify this
            CONTAINSSTRING( [Data Source], &quot;GL_PCA&quot; ), &quot;Balance Sheet&quot;,
            CONTAINSSTRING( [Data Source], &quot;Corporate S4 Reconciliation Input&quot; ), &quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;Greater China S4 Revenue Adj&quot; ), &quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;Americas S4 Revenue Adj&quot; ),&quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;EMEA S4 Revenue Adj&quot; ), &quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;SAP&quot; ), &quot;SAP&quot;, 
            CONTAINSSTRING( [Data Source], &quot;S4&quot; ), &quot;SAP&quot;,
            CONTAINSSTRING( [Data Source], &quot;Freight Review&quot; ), &quot;Freight&quot;,
            CONTAINSSTRING( [Data Source], &quot;Market Model&quot; ), &quot;Market Model&quot;,
            CONTAINSSTRING( [Data Source], &quot;P-CODE&quot; ), &quot;P-Code&quot;,
            CONTAINSSTRING( [Data Source], &quot;CMR&quot; ), &quot;CMR&quot;, 
            CONTAINSSTRING( [Data Source], &quot;SPEND BY COST CENTER&quot; ), &quot;CMR&quot;,
            CONTAINSSTRING( [Data Source], &quot;Target&quot; ), &quot;Targets&quot;,
            CONTAINSSTRING( [Data Source], &quot;CAPEX&quot; ), &quot;CAPEX&quot;,
            CONTAINSSTRING( [Data Source], &quot;Weekly Sales&quot; ), &quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;WORKFORCE&quot; ), &quot;Workforce&quot;,
            CONTAINSSTRING( [Data Source], &quot;OPC&quot; ), &quot;OPC&quot;,
            CONTAINSSTRING( [Data Source], &quot;OTHER EXPENSE&quot; ), &quot;Other Expense&quot;,
            CONTAINSSTRING( [Data Source], &quot;Input&quot; ), &quot;Input - Other&quot;,
            CONTAINSSTRING( [Data Source], &quot;BW_Inventory&quot; ), &quot;BW Inventory&quot;,
            CONTAINSSTRING( [Data Source], &quot;.xlsx&quot; ), &quot;Input - Other&quot;,

            &quot;Other&quot;
        )
    )
var _addSourceFacts =
    ADDCOLUMNS(
        _addCategories
        , &quot;Data Source Fact&quot;
        , SWITCH(
            TRUE(),
            // Snowflake and SAP S4
            CONTAINSSTRING( [Data Source], &quot;GL_DTL&quot; ), &quot;Weekly Sales&quot;,
            CONTAINSSTRING( [Data Source], &quot;GL_PCA&quot; ), &quot;Balance Sheet&quot;,
            CONTAINSSTRING( [Data Source], &quot;SAP&quot; ), &quot;Weekly Sales&quot;,
            // INPUT SHEETS
            CONTAINSSTRING( [Data Source], &quot;CMR BS&quot; ), &quot;Balance Sheet&quot;, 
            CONTAINSSTRING( [Data Source], &quot;CMR IS&quot; ), &quot;Income Statement&quot;,
            CONTAINSSTRING( [Data Source], &quot;CMR PL&quot; ), &quot;Profit &amp; Loss&quot;,
            CONTAINSSTRING( [Data Source], &quot;CMR COGS&quot; ), &quot;COGS&quot;, 

            [Data Source Category]
        )
    )
RETURN _addSourceFacts</code></pre>
</div>
</div>
<div id="greeting-the-user" class="section level1">
<h1>Greeting the User</h1>
<p>Let's create a measure to greet the Power BI user.</p>
<pre><code>Logged In User Name = 
VAR _user_name =
        LOOKUPVALUE (
            &#39;Fact_RLS&#39;[User],
            Fact_RLS[Email Address], USERPRINCIPALNAME ()
        )
RETURN
    &quot;Hi!, &quot; &amp; IF (
        LEN ( _user_name ) &gt; 20,
        LEFT (_user_name, 17) &amp; &quot;...&quot;,
        _user_name
    )
</code></pre>
<!--\1   <a href="#top">Back to top</a> \1-->
<p><a href="#top" style="color:steelblue;" >Back to top</a> <a
href="#"><svg preserveAspectRatio="none" aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:2em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg></a></p>
<!--\1  
## Objectives
> This tutorial provides a guideline to embed a 
Power Bi into HTML using R Markdown.

<iframe title="nycflights13" width="1140" height="541.25" src="https://app.powerbi.com/reportEmbed?reportId=922be8bf-a36f-40ec-8e45-424c1acec091&autoAuth=true&ctid=2910c8d0-a9d7-4737-800d-125cbd9916bc" frameborder="0" allowFullScreen="true"></iframe>
\1-->
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
